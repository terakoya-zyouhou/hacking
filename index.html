<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>é«˜æ ¡ç”Ÿå‘ã‘ãƒ»ãƒãƒƒã‚­ãƒ³ã‚°ä½“é¨“ãƒ©ãƒœ</title>
<style>
  :root{--bg:#0f1222;--card:#151a2f;--ink:#eef1ff;--sub:#a9add6;--ok:#1dd18c;--warn:#ffb02e;--bad:#ff5f7a;--acc:#7aa2ff}
  *{box-sizing:border-box}
  body{margin:0;background:linear-gradient(180deg,#0d1020,#0e1530 45%,#0b1020);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans JP",sans-serif}
  header{padding:28px 16px;text-align:center;border-bottom:1px solid #243055}
  header h1{margin:0 0 6px;font-size:28px}
  header p{margin:0;color:var(--sub)}
  main{max-width:980px;margin:20px auto;padding:0 14px;display:grid;gap:12px}
  .card{background:var(--card);border:1px solid #223059;border-radius:16px;overflow:hidden}
  .card>header{display:flex;justify-content:space-between;align-items:center;background:#131939;padding:12px 14px;border-bottom:1px solid #223059}
  .card>header h2{margin:0;font-size:18px}
  .body{padding:14px;display:grid;gap:10px}
  .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
  input,textarea,button{border-radius:12px;border:1px solid #2a355d;background:#0f1430;color:var(--ink)}
  input,button{padding:10px 12px}
  textarea{padding:10px 12px;min-height:90px;width:100%}
  button{cursor:pointer;font-weight:600}
  .btn{background:#1b2a62;border-color:#27428f}
  .btn-ghost{background:transparent}
  .btn-bad{background:#2a1520;border-color:#4b293b}
  .pill{display:inline-flex;align-items:center;gap:6px;border:1px solid #2a355d;padding:2px 8px;border-radius:999px}
  .ok{color:var(--ok)} .bad{color:var(--bad)} .sub{color:var(--sub)}
  .out{background:#0b0f24;border:1px dashed #2a355d;border-radius:12px;padding:10px;min-height:44px}
  .code{font-family:ui-monospace,SFMono-Regular,Consolas,Menlo,monospace;background:#0b0f24;border:1px solid #2a355d;border-radius:12px;padding:10px;overflow:auto}
  footer{padding:24px;text-align:center;color:var(--sub)}
  .hudbar{display:flex;gap:8px;flex-wrap:wrap;align-items:center;justify-content:center;margin-top:10px}
</style>
</head>
<body>
<header>
  <h1>ğŸ” é«˜æ ¡ç”Ÿå‘ã‘ãƒ»ãƒãƒƒã‚­ãƒ³ã‚°ä½“é¨“ãƒ©ãƒœ</h1>
  <p>ä»•æ›ã‘ã‚‹å´ã®è¦–ç‚¹ã§ â€œ3ã¤ã ã‘â€ ä½“é¨“ï¼šSQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ / ã‚¯ãƒ­ã‚¹ã‚µã‚¤ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒ†ã‚£ãƒ³ã‚° / ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒ</p>
  <p class="sub" style="font-size:12px">â€» ã“ã®æ•™æã¯<strong>å­¦ç¿’å°‚ç”¨</strong>ã§ã™ã€‚å®Ÿã‚µãƒ¼ãƒ“ã‚¹ãƒ»ç¬¬ä¸‰è€…ç’°å¢ƒã¸ã®æ”»æ’ƒã¯<strong>çµ¶å¯¾ã«ç¦æ­¢</strong>ã§ã™ã€‚</p>
</header>

<main id="app"></main>

<footer>Â© ã‚¨ã‚·ã‚«ãƒ«å­¦ç¿’ç”¨ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³: simple-3-missions</footer>

<script>
/* ====== ä¾¿åˆ©é–¢æ•° ====== */
const $ = s => document.querySelector(s);
const el = (tag, attrs={}, children=[])=>{const n=document.createElement(tag);for(const[k,v] of Object.entries(attrs)){if(k==='class') n.className=v;else if(k.startsWith('on')&&typeof v==='function') n.addEventListener(k.slice(2),v);else n.setAttribute(k,v);} (Array.isArray(children)?children:[children]).forEach(c=>n.append(c instanceof Node?c:document.createTextNode(c)));return n;};
const sanitize = (s)=>{const d=document.createElement('div'); d.innerText=s; return d.innerHTML;};

/* ====== é€²æ—ï¼ˆã‚¹ã‚³ã‚¢ãªã—ï¼‰ ====== */
const KEY = 'simple_lab_progress_v1';
const state = JSON.parse(localStorage.getItem(KEY) || '{"solved":{}}');
function save(){ localStorage.setItem(KEY, JSON.stringify(state)); }
function markSolved(id){ if(!state.solved[id]){ state.solved[id]=true; save(); const tag = document.querySelector(`#m${id} header .pill`); if(tag) tag.textContent = 'âœ… ã‚¯ãƒªã‚¢æ¸ˆ'; alert('ğŸ‰ ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚¯ãƒªã‚¢ï¼'); } }

/* ====== å…±é€šã‚«ãƒ¼ãƒ‰ ====== */
function card(id,title,build){
  const section=el('section',{class:'card',id:'m'+id},[
    el('header',{},[
      el('h2',{},[id+'. '+title]),
      el('span',{class:'pill'},[ state.solved?.[id] ? 'âœ… ã‚¯ãƒªã‚¢æ¸ˆ' : 'æœªã‚¯ãƒªã‚¢' ])
    ]),
    el('div',{class:'body'})
  ]);
  build(section.querySelector('.body'), ()=>markSolved(id));
  return section;
}

const app = $('#app');

/* ====== M1: SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆç–‘ä¼¼ãƒ­ã‚°ã‚¤ãƒ³å›é¿ï¼‰ ====== */
app.append(card(1,'SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ï¼š\' OR \'1\'=\'1 ã§èªè¨¼å›é¿', (body, solved)=>{
  const users=[{id:1,username:'taro',pass:'apple'},{id:2,username:'hanako',pass:'book'}];
  const u=el('input',{placeholder:'ãƒ¦ãƒ¼ã‚¶ãƒ¼å ä¾‹: taro'});
  const p=el('input',{placeholder:'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ ä¾‹: apple', type:'text'});
  const btn=el('button',{class:'btn'},['ãƒ­ã‚°ã‚¤ãƒ³ï¼ˆè„†å¼±ï¼‰']);
  const out=el('div',{class:'out'});
  btn.onclick=()=>{
    const where = `username='${u.value}' AND pass='${p.value}'`;
    // è„†å¼±ï¼šæ–‡å­—åˆ—é€£çµãƒ™ãƒ¼ã‚¹ã®ç–‘ä¼¼ã‚¯ã‚¨ãƒªåˆ¤å®š
    const bypass = /'\s*OR\s*'1'\s*=\s*'1/i.test(p.value);
    const ok = bypass || users.some(x=>x.username===u.value && x.pass===p.value);
    out.innerHTML = `<div class="code">SELECT * FROM users WHERE ${sanitize(where)}</div>` + (ok? '<p class="ok">âœ… ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸï¼ˆèªè¨¼å›é¿ã®å¯èƒ½æ€§ï¼‰</p>' : '<p class="bad">âŒ å¤±æ•—</p>');
    if(bypass) solved();
  };
  body.append(
    el('p',{},['ç›®çš„ï¼šãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ¬„ã« ', el('span',{class:'code'},['\' OR \'1\'=\'1']), ' ã‚’å…¥ã‚Œã¦ç–‘ä¼¼ãƒ­ã‚°ã‚¤ãƒ³ã‚’å›é¿ã€‚']),
    el('div',{class:'row'},[u,p,btn]),
    out,
    el('details',{},[
      el('summary',{},['ãƒ’ãƒ³ãƒˆ']),
      el('div',{},['ã‚¯ã‚¨ãƒªãŒæ–‡å­—åˆ—é€£çµã§çµ„ã¾ã‚Œã¦ã„ã‚‹ã¨ã€OR æ¡ä»¶ã‚’å·®ã—è¾¼ã‚ã¾ã™ã€‚'])
    ])
  );
}));

/* ====== M2: XSSï¼ˆåå°„å‹ï¼šå…¥åŠ›ã‚’ãã®ã¾ã¾æç”»ï¼‰ ====== */
app.append(card(2,'ã‚¯ãƒ­ã‚¹ã‚µã‚¤ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒ†ã‚£ãƒ³ã‚°ï¼šã‚¯ãƒ­ã‚¹ã‚µã‚¤ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒ†ã‚£ãƒ³ã‚°ã§ã‚¢ãƒ©ãƒ¼ãƒˆ', (body, solved)=>{
  const i=el('input',{placeholder:"ä¾‹: <img src=x onerror=alert('XSS')>"});
  const btn=el('button',{class:'btn'},['ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆè„†å¼±ï¼‰']);
  const safeBtn=el('button',{class:'btn-ghost'},['å®‰å…¨ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆç„¡å®³åŒ–ï¼‰']);
  const out=el('div',{class:'out'},'ã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™');
  btn.onclick=()=>{ out.innerHTML = i.value; if(out.querySelector('script')||out.querySelector('[onerror],[onload]')) solved(); };
  safeBtn.onclick=()=>{ out.innerHTML = sanitize(i.value); };
  body.append(
    el('p',{},['ç›®çš„ï¼šå…¥åŠ›ã‚’ãã®ã¾ã¾ innerHTML ã«å…¥ã‚Œã‚‹ã¨å±é™ºã€‚onerror ãªã©ã§å®Ÿè¡Œã•ã›ã‚‰ã‚Œã‚‹ã€‚']),
    el('div',{class:'row'},[i,btn,safeBtn]),
    out,
    el('details',{},[
      el('summary',{},['ãƒ’ãƒ³ãƒˆ']),
      el('div',{},['ã‚¿ã‚°ã‚’é–‰ã˜ã¦ã‚¤ãƒ™ãƒ³ãƒˆå±æ€§ã‚’ä½¿ã†æ–¹æ³•ï¼ˆä¾‹ï¼š', el('span',{class:'code'},["<img src=x onerror=alert('XSS')>"]), 'ï¼‰'])
    ])
  );
}));

/* ====== M3: ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ï¼ˆç·å½“ã‚Šï¼‰ ====== */
app.append(card(3,'ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒï¼šè¾æ›¸æ”»æ’ƒã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿', (body, solved)=>{
  // è¢«æ”»æ’ƒå´ï¼šå¼±ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã€ãƒ­ãƒƒã‚¯ã‚¢ã‚¦ãƒˆç„¡ã—
  const targetUser = { username:'student', password:'pass123' };
  const passInput=el('input',{placeholder:'å˜ç™ºãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰è©¦è¡Œï¼ˆä¾‹: pass123ï¼‰'});
  const tryBtn=el('button',{class:'btn'},['1å›ã ã‘è©¦ã™']);
  const out=el('div',{class:'out'});

  // æ”»æ’ƒå´ï¼šè¾æ›¸ãƒªã‚¹ãƒˆ
  const wordlist = ['0000','1111','password','qwerty','letmein','pass123','admin','welcome'];
  const autoBtn=el('button',{class:'btn-bad'},['è¾æ›¸æ”»æ’ƒã‚¹ã‚¿ãƒ¼ãƒˆ']);
  const stopBtn=el('button',{class:'btn-ghost'},['åœæ­¢']);

  let tries=0, timer=null, idx=0;

  function log(msg){ out.innerHTML += `<div>${sanitize(msg)}</div>`; out.scrollTop=out.scrollHeight; }
  function reset(){ tries=0; idx=0; clearInterval(timer); timer=null; out.innerHTML=''; }

  tryBtn.onclick=()=>{
    const ok = passInput.value===targetUser.password;
    log(`è©¦è¡Œ: ${passInput.value} â†’ ${ok? 'âœ… æˆåŠŸ' : 'âŒ å¤±æ•—'}`);
    if(ok) solved();
  };

  autoBtn.onclick=()=>{
    if(timer) return; out.innerHTML=''; tries=0; idx=0;
    log('è¾æ›¸æ”»æ’ƒã‚’é–‹å§‹â€¦ï¼ˆãƒ­ãƒƒã‚¯ã‚¢ã‚¦ãƒˆãƒ»CAPTCHA ç„¡ã—ã®æƒ³å®šï¼‰');
    timer=setInterval(()=>{
      if(idx>=wordlist.length){ clearInterval(timer); timer=null; log('è¾æ›¸æ¯æ¸‡ï¼šå¤±æ•—'); return; }
      const cand = wordlist[idx++]; tries++;
      const ok = cand===targetUser.password;
      log(`è©¦è¡Œ#${tries}: ${cand} â†’ ${ok? 'âœ… æˆåŠŸ' : 'âŒ å¤±æ•—'}`);
      if(ok){ clearInterval(timer); timer=null; log('\nâ¡ï¸ æˆåŠŸï¼šãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒç‰¹å®šã•ã‚Œã¾ã—ãŸã€‚'); solved(); }
    }, 300);
  };

  stopBtn.onclick=()=>{ clearInterval(timer); timer=null; log('åœæ­¢ã—ã¾ã—ãŸã€‚'); };

  body.append(
    el('p',{},['ç›®çš„ï¼šå¼±ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ + ãƒ­ãƒƒã‚¯ã‚¢ã‚¦ãƒˆç„¡ã—ã®ç’°å¢ƒã§ã€è¾æ›¸æ”»æ’ƒãŒé€šã‚‹æ§˜å­ã‚’ä½“é¨“ã™ã‚‹ã€‚']),
    el('div',{class:'row'},[passInput, tryBtn]),
    el('div',{class:'row'},[autoBtn, stopBtn]),
    out,
    el('details',{},[
      el('summary',{},['ãƒ’ãƒ³ãƒˆï¼ˆå®ˆã‚‹å´ã®å¯¾ç­–ï¼‰']),
      el('ul',{},[
        el('li',{},['è©¦è¡Œå›æ•°åˆ¶é™ã¨ä¸€æ™‚ãƒ­ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ']),
        el('li',{},['CAPTCHA ã‚„å¤šè¦ç´ èªè¨¼ï¼ˆMFAï¼‰']),
        el('li',{},['ãƒ©ãƒ³ãƒ€ãƒ ã§é•·ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ + ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼'])
      ])
    ])
  );
}));
</script>
</body>
</html>

